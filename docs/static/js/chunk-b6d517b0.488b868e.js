(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b6d517b0"],{"0c98":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoyNzBDMDlEMzEyNjNFODExQjEwM0ZEMDUzQjUwOTVDNSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo5Qjc3RUZDMjU1QTAxMUU4QTM0REU5NTIyNEQwRTA3NSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5QjZBQTkwQzU1QTAxMUU4QTM0REU5NTIyNEQwRTA3NSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M2IChXaW5kb3dzKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjIyNkQ1OTRERjA3NUU4MTE5MEM0RTMyNUQ0OUFGRjNGIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjI3MEMwOUQzMTI2M0U4MTFCMTAzRkQwNTNCNTA5NUM1Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+oQUKrgAAARlJREFUeNpi/P//PwM1AQuMwXbtIz51zUCcD8SrgDgFl6JfWvwIA4HABYiVcKh1A2JeILYH4jQcah4A8S5GmJeBLnwJpMQo8O1roAvFkF2oC8SRQDwB6q39UHEOIP4BxIxADLKdE4i/I+ljB+KfQPwBxGFCkngFxHeg7BdAfA+IBYH4EhDLAPFdkEeA+Dw0aEDyv4H4AhDrA/E7dAOxAQkgZoYaCAIiQMyKFDQCUEskYBqYGKgMRg0cNZCKBnJD6dvQ3HMTyn8EFbsH5fPiLL6gAFY4goqqL6ASCYgzoVnQBSqXBcQ8QOwBxHlQsX+4DDwLxG+A2AqItxLpy29AfBiXgaAiTB2IDYgMX5CPrkILEzBgpHYVABBgAHeMO+lCH77HAAAAAElFTkSuQmCC"},"361a":function(t,e,a){},8899:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoyNzBDMDlEMzEyNjNFODExQjEwM0ZEMDUzQjUwOTVDNSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoyMDQ1OUJGQzdBOUUxMUU4QkE0M0QwQzFBRTFBMThENCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoyMDQ1OUJGQjdBOUUxMUU4QkE0M0QwQzFBRTFBMThENCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M2IChXaW5kb3dzKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjE0NzYyMzk0RkI3NUU4MTE4MjNGRUFBM0NEODI0MDczIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjI3MEMwOUQzMTI2M0U4MTFCMTAzRkQwNTNCNTA5NUM1Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+S4qwywAAASZJREFUeNqUk01OAkEQhacn6JbFyAUk0SALFpKg3oE144JTIF4COAFLF4wXESS4cAEBEr2AksiWhc175A3pGJufSr70pKZedXV1l7HWBqmdTpYhlhq4BzcgB77AAPTA8+oq+5vGh47wHMsQVEEXFIHR2pV/qLiNGe4sRx+0QDvw2wNogltU8GlOxj/c/ZUl7RG6CXi0CoUxmHuEk398bcXHFNfBk2eXgsfP+DrFZTAKjrN3UKL4DHw7P2bAisD5njkxCxBlJHQTXDpBVtf11yImCFVy+ciySyw9TA/vCZp6/JsmU5yAC9A4sNsNxScZvlW8MN71i352dpRL4SO4o86kg4EEeb2yuYbgTU2M1JNYzaxB+LF9256putYtLNRUHi9xp2otwAB4dF0zIdKZ0wAAAABJRU5ErkJggg=="},a6df:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAb1BMVEUAAAAhcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsgUow07AAAAJHRSTlMA6Ntj4b9JDuze1cq0nVLOlotpXlpYPyghHBYGqKeQh359czdcUwWKAAAAg0lEQVQY03WPRxLDIBAEB0SQAKFkZWfz/zfaiwoXF/VlqveyMzhhcXLOdH+GH51OPlYhwoqoFxP+cDoVIeMN4pX0EbXx0DdSt0FZAAOzGh8uJuyy7EG0rKa4HwHeQ0umJtFsGAy95WaGqoTHasXRpCuvFHXZpqqrY8XI5JKtUbzyJ7u/sQ8KrkbMHycAAAAASUVORK5CYII="},cd0b:function(t,e,a){"use strict";a.r(e);var l=function(){var t=this,e=t.$createElement,l=t._self._c||e;return l("div",{staticClass:"data-excel"},[l("div",{staticClass:"data-item"},[l("div",{staticClass:"text"},[t._v("选择配置")]),l("div",{staticClass:"comp data-item-float"},[l("el-select",{staticClass:"left",attrs:{value:t.selectExcelId,placeholder:"请选择",size:"mini"},on:{change:t.updateExcelId}},t._l(t.dataSourceList,(function(t){return l("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1),l("el-button",{staticClass:"right",attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.showUploadDialog("uploadData")}}},[t._v("新 建")])],1)]),l("div",{staticClass:"data-item"},[l("div",{staticClass:"comp data-item-float"},[l("span",{staticClass:"left",staticStyle:{width:"200px"}},[t._v("数据源状态 "+t._s(t.excelState))])])]),l("el-radio",{attrs:{label:"1"},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[t._v("按条件筛选")]),l("el-radio",{attrs:{label:"2"},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[t._v("按SQL筛选")]),1==t.radio?l("div",[l("div",{staticClass:"data-item"},[l("div",{staticClass:"text"},[t._v("选择列")]),l("el-select",{staticClass:"comp",attrs:{multiple:!0,value:t.selectColumns,size:"mini"},on:{change:t.changeColumns}},t._l(t.allColumns,(function(t){return l("el-option",{key:t,attrs:{value:t}})})),1)],1),l("hr",{staticClass:"separate-line"}),l("div",{staticClass:"data-item"},[l("div",{staticClass:"text"},[t._v("选择查询条件")]),l("div",{staticClass:"comp data-item-float"},[l("span",{staticClass:"left",staticStyle:{width:"30px"}},[t._v("列名")]),l("el-select",{staticClass:"right",staticStyle:{width:"280px"},attrs:{size:"mini"},model:{value:t.columnName,callback:function(e){t.columnName=e},expression:"columnName"}},t._l(t.allColumns,(function(t){return l("el-option",{key:t,attrs:{value:t}})})),1)],1),l("div",{staticClass:"comp data-item-float"},[l("span",{staticClass:"left",staticStyle:{width:"43px"}},[t._v("值")]),l("el-input",{staticClass:"left",staticStyle:{width:"240px"},attrs:{type:"text",size:"mini"},model:{value:t.columnValue,callback:function(e){t.columnValue=e},expression:"columnValue"}}),l("img",{staticClass:"right btn-img",attrs:{src:a("8899")},on:{click:t.addConditions}})],1),l("hr",{staticClass:"separate-line"}),t.getQueryConditions.length>0?l("el-table",{staticStyle:{width:"100%"},attrs:{data:t.getQueryConditions,size:"mini"}},[l("el-table-column",{attrs:{label:"列名",align:"center","header-align":"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[l("span",[t._v(t._s(e.row.name))])]}}],null,!1,2020036417)}),l("el-table-column",{attrs:{align:"center","header-align":"center",label:"值"},scopedSlots:t._u([{key:"default",fn:function(e){return[l("span",[t._v(t._s(e.row.value))])]}}],null,!1,1320824237)}),l("el-table-column",{attrs:{label:"操作",align:"center","header-align":"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[l("img",{staticClass:"right btn-img",attrs:{src:a("0c98")},on:{click:function(a){return t.delConditions(e.$index,e.row)}}})]}}],null,!1,3359973329)})],1):t._e(),l("hr",{staticClass:"separate-line"}),l("div",{staticClass:"text"},[t._v("排序方式")]),l("div",{staticClass:"comp data-item-float"},[l("span",{staticClass:"left",staticStyle:{width:"30px"}},[t._v("列名")]),l("el-select",{staticClass:"right",staticStyle:{width:"280px"},attrs:{size:"mini"},model:{value:t.sortColumnName,callback:function(e){t.sortColumnName=e},expression:"sortColumnName"}},t._l(t.allColumns,(function(t){return l("el-option",{key:t,attrs:{value:t}})})),1)],1),l("div",{staticClass:"comp data-item-float"},[l("span",{staticClass:"left",staticStyle:{width:"43px"}},[t._v("排序")]),l("img",{staticClass:"right btn-img",attrs:{src:a("8899")},on:{click:t.addExcelSortArr}}),l("el-select",{staticClass:"right",staticStyle:{width:"240px"},attrs:{size:"mini"},model:{value:t.sortVal,callback:function(e){t.sortVal=e},expression:"sortVal"}},t._l(t.sortValOpn,(function(t){return l("el-option",{key:t.label,attrs:{label:t.label,value:t.value}})})),1)],1),t.excelSortArr.length>0?l("el-table",{staticStyle:{width:"100%"},attrs:{data:t.excelSortArr,size:"mini"}},[l("el-table-column",{attrs:{label:"列名",align:"center","header-align":"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[l("span",[t._v(t._s(e.row.name))])]}}],null,!1,2020036417)}),l("el-table-column",{attrs:{align:"center","header-align":"center",label:"排序"},scopedSlots:t._u([{key:"default",fn:function(e){return[l("span",[t._v(t._s("asc"==e.row.sort?"正序":"倒序"))])]}}],null,!1,614357657)}),l("el-table-column",{attrs:{label:"操作",align:"center","header-align":"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[l("img",{staticClass:"right btn-img",attrs:{src:a("0c98")},on:{click:function(a){return t.delExcelSortArr(e.$index,e.row)}}})]}}],null,!1,1778551837)})],1):t._e()],1)]):l("div",[l("div",{staticClass:"text",staticStyle:{"margin-top":"15px","margin-bottom":"15px"}},[t._v("查询的sql， "),l("font",{attrs:{color:"red"}},[t._v('注(表名请按照"#{表名}"格式填写)')])],1),l("div",{staticClass:"data-item"},[l("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入sql"},model:{value:t.excelSortSql,callback:function(e){t.excelSortSql=e},expression:"excelSortSql"}})],1)]),l(t.showDataUI,{tag:"component"}),l("el-dialog",{staticClass:"common-dialog",attrs:{title:"新建excel数据源",visible:t.dialogVisible,"modal-append-to-body":!1,width:"40%","before-close":t.handleClose,"show-close":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[l("div",{staticClass:"el-dialog__title",attrs:{slot:"title"},slot:"title"},[l("img",{attrs:{src:a("a6df"),alt:"",width:"16",height:"16"}}),l("p",{staticClass:"title"},[t._v("新建excel数据源")])]),l("el-form",{ref:"uploadData",attrs:{model:t.uploadData,rules:t.rules,"label-width":"100px",size:"mini"}},[l("el-form-item",{attrs:{label:"名称",prop:"name"}},[l("el-input",{model:{value:t.uploadData.name,callback:function(e){t.$set(t.uploadData,"name",e)},expression:"uploadData.name"}})],1),l("el-form-item",{attrs:{label:"excel文件",prop:"excelFile"}},[l("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{name:"file",action:t.uploadUrl,data:t.uploadData,"on-change":t.changeFile,"on-remove":t.handleRemove,"on-success":t.handleSuccess,"on-error":t.handleError,"auto-upload":!1,multiple:!1,limit:1}},[l("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("选择")]),l("div",{staticClass:"el-upload__tip",staticStyle:{display:"inline-block","margin-left":"10px"},attrs:{slot:"tip"},slot:"tip"},[t._v(" 只能上传excel文件")])],1)],1)],1),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{staticClass:"primary-button",attrs:{type:"primary"},on:{click:function(e){return t.submitForm("uploadData")}}},[t._v("确 定")]),l("el-button",{staticClass:"info-button",on:{click:function(e){return t.handleClose()}}},[t._v("取 消")])],1)],1)],1)},s=[],i=(a("445a"),a("13cf"),a("989e"),a("1d7a"),a("0bd5"),a("9b42"),a("79a8"),a("8676"),a("1377")),c=a("d211"),o=a("cf6b"),n=a("ee48"),r=a("5b12"),u=a("07a4"),d={name:"ExcelData",data:function(){return{dialogVisible:!1,dataSourceList:Object(n["e"])(),uploadUrl:n["a"],sortColumnName:"",sqlName:"",sql:"",uploadData:{name:"",excelFile:"",type:"1"},rules:{name:[{required:!0,message:"请输入数据源名称",trigger:"blur"},{min:5,max:20,message:"长度在5到20个字符",trigger:"blur"}],excelFile:[{required:!0,message:"请选择excel文件",trigger:"blur"}]},radio:"1",columnName:"",columnValue:"",sortVal:"asc",excelState:"",sortValOpn:[{value:"asc",label:"正序"},{value:"desc",label:"倒序"}],allState:{1:"上传中",2:"上传完成",3:"上传失败"},allColumns:""}},computed:Object(c["a"])(Object(c["a"])({},Object(o["c"])({activeComp:"getFirstActiveComp",getCompData:"getCompData"})),{},{selectExcelId:function(){var t=Object(r["a"])("datasource excelId");return t},selectColumns:function(){return Object(r["a"])("datasource excelColumns")},getQueryConditions:function(){return Object(r["a"])("datasource excelConditions")},excelSortArr:function(){return Object(r["a"])("datasource excelSortArr")},excelSortSql:{get:function(){return""==Object(r["a"])("datasource excelSortSql")&&Object(r["c"])("datasource excelSortSql","select * from #{"+this.sqlName+"}"),Object(r["a"])("datasource excelSortSql")},set:function(t){Object(r["c"])("datasource excelSortSql",t)}},showDataUI:function(){return r["e"].showData}}),mounted:function(){""!=this.selectExcelId&&(this.changeBox(this.selectExcelId),this.getSelectName(this.selectExcelId),this.radio=u["a"].state.components.sqlParmas.radio)},methods:{handleClose:function(){this.dialogVisible=!1},loadAllColumns:function(){this.allColumns=Object(n["d"])(this.selectExcelId)},showUploadDialog:function(t){this.dialogVisible=!0,this.$refs[t]&&(this.$refs[t].resetFields(),this.$refs[t].clearValidate(),this.$refs.upload&&this.$refs.upload.clearFiles())},submitForm:function(t){var e=this;this.$refs[t].validate((function(t){if(!t)return console.log("error submit!!"),!1;e.$refs.upload.submit()}))},changeFile:function(t,e){if(null!=t){var a=t.name.split(".")[1],l="xls"===a||"xlsx"===a;l?this.uploadData.excelFile=t.name:this.rules.excelFile[0].message="文件扩展名必须是xls或xlsx"}},handleRemove:function(t){this.uploadData.excelFile="",this.rules.excelFile[0].message="请选择excel文件",console.log("remove:",t.name)},handleSuccess:function(t,e,a){if(200!=t.status)return console.log("response:",t),void this.$alert(t.message,"提示",{confirmButtonText:"确定"});this.$alert("上传成功","提示",{confirmButtonText:"确定"}),this.dialogVisible=!1,this.dataSourceList=Object(n["e"])(),this.updateExcelId(t.id),this.excelState=this.allState["1"],this.crontab(),this.columnName="",this.columnValue=""},handleError:function(t,e,a){this.$alert("上传失败","提示",{confirmButtonText:"确定"})},changeBox:function(t){var e,a=Object(i["a"])(this.dataSourceList);try{for(a.s();!(e=a.n()).done;){var l=e.value;if(l.id==t){this.excelState=this.allState[l.status],2==l.status&&this.loadAllColumns();break}}}catch(s){a.e(s)}finally{a.f()}},updateSql:function(t){Object(r["c"])("datasource excelSortSql","select * from #{"+t+"}")},getSelectName:function(t){var e={};e=this.dataSourceList.find((function(e){return e.id===t})),this.sqlName=e.name,this.updateSql(this.sqlName)},updateExcelId:function(t){Object(r["c"])("datasource excelId",t);var e,a=Object(i["a"])(this.dataSourceList);try{for(a.s();!(e=a.n()).done;){var l=e.value;if(l.id==t){this.excelState=this.allState[l.status],2==l.status&&this.loadAllColumns();break}}}catch(s){a.e(s)}finally{a.f()}t&&this.getSelectName(t),Object(r["c"])("datasource excelColumns",[]),Object(r["c"])("datasource excelConditions",[])},changeColumns:function(t){Object(r["c"])("datasource excelColumns",t)},addConditions:function(){var t=[].concat(this.getQueryConditions);t.push({name:this.columnName,value:this.columnValue}),Object(r["c"])("datasource excelConditions",t),this.columnName="",this.columnValue=""},crontab:function(){var t=this;this.crontabVal=setInterval((function(){t.excelState==t.allState["1"]?t.freshExcelState():clearInterval(t.crontabVal)}),1e3)},addExcelSortArr:function(){var t=[].concat(this.excelSortArr);t.push({name:this.sortColumnName,sort:this.sortVal}),Object(r["c"])("datasource excelSortArr",t),this.sortColumnName="",this.sortVal="asc"},delExcelSortArr:function(t){var e=[].concat(this.excelSortArr);e.splice(t,1),Object(r["c"])("datasource excelSortArr",e)},handleEdit:function(t,e){console.log(t,e)},handleDelete:function(t,e){console.log(t,e)},delConditions:function(t){var e=[].concat(this.getQueryConditions);e.splice(t,1),Object(r["c"])("datasource excelConditions",e)},freshExcelState:function(){var t=this.selectExcelId;if(t){var e=n["c"].replace("{id}",t),a=this;$.get(e,(function(t,e){a.excelState=a.allState[t],2==t&&a.loadAllColumns()}))}else this.$alert("请选择excel后再刷新状态","提示",{confirmButtonText:"确定"})}},watch:{radio:function(){u["a"].commit("uploadRadio",this.radio)}}},m=d,h=(a("ef14"),a("5d22")),A=Object(h["a"])(m,l,s,!1,null,"f6b101c8",null);e["default"]=A.exports},ee48:function(t,e,a){"use strict";a.d(e,"e",(function(){return o})),a.d(e,"d",(function(){return n})),a.d(e,"a",(function(){return i})),a.d(e,"b",(function(){return s})),a.d(e,"c",(function(){return c}));var l=a("0e0b"),s=l["a"].appServerURL()+"datasource/list/1",i=l["a"].appServerURL()+"datasource/upload/excelfile",c=(l["a"].appServerURL(),l["a"].appServerURL(),l["a"].appServerURL(),l["a"].appServerURL()+"datasource/file/{id}/status");function o(){var t=null;return t}function n(t){var e=null;return e}},ef14:function(t,e,a){"use strict";a("361a")}}]);