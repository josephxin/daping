(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8604bfde"],{"325a":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"data-database"},[s("div",{staticClass:"data-item"},[s("div",{staticClass:"text"},[e._v("选择配置")]),s("div",{staticClass:"comp data-item-float"},[s("el-select",{staticClass:"left",attrs:{value:e.databaseId,placeholder:"请选择",size:"mini"},on:{change:e.updateDatabaseId}},e._l(e.dataList,(function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),s("el-button",{staticClass:"right",attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.showDatabaseDialog("form")}}},[e._v("新 建")])],1)]),s("div",{staticClass:"data-item"},[s("div",{staticClass:"text"},[e._v("查询语句")]),s("el-input",{staticClass:"comp",attrs:{type:"textarea",rows:6},on:{change:e.updateSql},model:{value:e.sql,callback:function(t){e.sql=t},expression:"sql"}})],1),s(e.showDataUI,{tag:"component"}),s("el-dialog",{staticClass:"common-dialog",attrs:{title:"新建数据库数据源",visible:e.dialogVisible,"modal-append-to-body":!1,"before-close":e.handleClose,width:"40%","show-close":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("div",{staticClass:"el-dialog__title",attrs:{slot:"title"},slot:"title"},[s("img",{attrs:{src:a("a6df"),alt:"",width:"16",height:"16"}}),s("p",{staticClass:"title"},[e._v("新建数据库数据源")])]),s("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px",size:"mini"}},[s("el-form-item",{attrs:{label:"名称",prop:"name"}},[s("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),s("el-form-item",{attrs:{label:"类型",prop:"type"}},[s("el-select",{staticStyle:{width:"100%"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.dbType,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),s("el-form-item",{attrs:{label:"用户名",prop:"username"}},[s("el-input",{model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{attrs:{type:"password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),s("el-form-item",{attrs:{label:"域名",prop:"domain"}},[s("el-input",{model:{value:e.form.domain,callback:function(t){e.$set(e.form,"domain",t)},expression:"form.domain"}})],1),s("el-form-item",{attrs:{label:"端口",prop:"port"}},[s("el-input",{model:{value:e.form.port,callback:function(t){e.$set(e.form,"port",t)},expression:"form.port"}})],1),s("el-form-item",{attrs:{label:"db名称",prop:"dbName"}},[s("el-input",{model:{value:e.form.dbName,callback:function(t){e.$set(e.form,"dbName",t)},expression:"form.dbName"}})],1),s("el-form-item",{attrs:{label:"备注",prop:"remark"}},[s("el-input",{attrs:{type:"textarea"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{staticClass:"primary-button",attrs:{type:"primary"},on:{click:function(t){return e.submitForm("form")}}},[e._v("确 定")]),s("el-button",{staticClass:"info-button",on:{click:function(t){return e.handleClose()}}},[e._v("取 消")])],1)],1)],1)},r=[],o=(a("1d7a"),a("e9df")),l=a("5b12"),i={name:"DatabaseData",data:function(){return{dialogVisible:!1,dataList:[],dbType:[{value:"mysql",label:"mysql"},{value:"oracle",label:"oracle"},{value:"db2",label:"db2"},{value:"sqlserver",label:"sqlserver"}],form:{name:"",type:"",domain:"",username:"",password:"",port:"",dbName:"",remark:""},rules:{name:[{required:!0,message:"请输入数据源名称",trigger:"blur"},{min:5,max:20,message:"长度在 5 到 20 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:"blur"}],username:[{required:!0,message:"请输入用户名称",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],domain:[{required:!0,message:"请输入域名",trigger:"blur"}],port:[{required:!0,message:"请输入端口",trigger:"blur"}],dbName:[{required:!0,message:"请输入数据库实例名称",trigger:"blur"}]},sql:""}},mounted:function(){this.sql=this.getVal("datasource sql")},computed:{databaseId:function(){return Object(l["a"])("datasource databaseId")},showDataUI:function(){return l["e"].showData}},created:function(){var e=this;Object(o["c"])().then((function(t){return e.dataList=t}))},methods:{handleClose:function(){this.dialogVisible=!1},showDatabaseDialog:function(e){this.dialogVisible=!0,this.$refs[e]&&(console.log("reset form"),this.$refs[e].resetFields(),this.$refs[e].clearValidate())},submitForm:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return console.log("error submit!!"),!1;var a=t;$.post(o["a"],{dbtype:t.form.type,name:t.form.name,username:t.form.username,password:t.form.password,host:t.form.domain,port:t.form.port,instance:t.form.dbName,remark:t.form.remark},(function(e){a.$alert("添加数据源成功","提示",{confirmButtonText:"确定"}),Object(o["c"])().then((function(t){a.dataList=t,a.updateDatabaseId(e.id)})),a.dialogVisible=!1}))}))},updateDatabaseId:function(e){Object(l["c"])("datasource databaseId",e),this.updateSql("")},updateSql:function(e){Object(l["c"])("datasource sql",e)}}},n=i,c=(a("e87a"),a("5d22")),u=Object(c["a"])(n,s,r,!1,null,"5008449d",null);t["default"]=u.exports},"60be":function(e,t,a){},a6df:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAb1BMVEUAAAAhcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsghcsgUow07AAAAJHRSTlMA6Ntj4b9JDuze1cq0nVLOlotpXlpYPyghHBYGqKeQh359czdcUwWKAAAAg0lEQVQY03WPRxLDIBAEB0SQAKFkZWfz/zfaiwoXF/VlqveyMzhhcXLOdH+GH51OPlYhwoqoFxP+cDoVIeMN4pX0EbXx0DdSt0FZAAOzGh8uJuyy7EG0rKa4HwHeQ0umJtFsGAy95WaGqoTHasXRpCuvFHXZpqqrY8XI5JKtUbzyJ7u/sQ8KrkbMHycAAAAASUVORK5CYII="},e87a:function(e,t,a){"use strict";a("60be")},e9df:function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return l}));a("6a61");var s=a("2e91"),r=a("0e0b"),o=a("07a4"),l=r["a"].appServerURL()+"datasource/sqldata/list",i=r["a"].appServerURL()+"datasource/sqldata/source";r["a"].appServerURL();function n(){return c.apply(this,arguments)}function c(){return c=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o["a"]._actions.getSourceList[0]();case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)}))),c.apply(this,arguments)}}}]);